---
interface Props {
  body?: any[];
}

const { body } = Astro.props;

if (!body?.length) return;

// Simple portable text renderer for basic block content
function renderBlock(block: any): string {
  if (block._type === "image") {
    const url = block.asset?.url || block.asset?._ref;
    return url ? `<figure class="my-8"><img src="${url}" alt="${block.alt || ""}" class="rounded-xl max-w-full" /></figure>` : "";
  }

  if (block._type !== "block") return "";

  const style = block.style || "normal";
  const text = (block.children || [])
    .map((child: any) => {
      let t = child.text || "";
      if (child.marks?.includes("strong")) t = `<strong>${t}</strong>`;
      if (child.marks?.includes("em")) t = `<em>${t}</em>`;
      if (child.marks?.includes("code")) t = `<code>${t}</code>`;
      return t;
    })
    .join("");

  switch (style) {
    case "h1":
      return `<h1 class="font-display text-4xl lg:text-5xl font-medium leading-tight tracking-[-0.96px] text-text-primary mb-6">${text}</h1>`;
    case "h2":
      return `<h2 class="font-display text-3xl lg:text-4xl font-medium leading-tight tracking-[-0.72px] text-text-primary mb-5">${text}</h2>`;
    case "h3":
      return `<h3 class="font-display text-2xl font-medium leading-8 text-text-primary mb-4">${text}</h3>`;
    case "h4":
      return `<h4 class="font-display text-xl font-medium leading-7 text-text-primary mb-3">${text}</h4>`;
    case "blockquote":
      return `<blockquote class="border-l-4 border-brand-accent pl-6 italic text-text-tertiary my-6">${text}</blockquote>`;
    default:
      return text ? `<p class="text-lg leading-7 text-text-tertiary mb-4">${text}</p>` : "";
  }
}

const html = body.map(renderBlock).join("\n");
---

<section class="relative z-[2] px-4 pb-2 bg-brand-800">
  <div class="max-w-[1920px] mx-auto bg-white rounded-3xl py-16 lg:py-24 overflow-hidden">
    <div class="max-w-[800px] mx-auto px-6 lg:px-8">
      <Fragment set:html={html} />
    </div>
  </div>
</section>
