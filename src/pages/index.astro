---
import BaseLayout from "@/layouts/BaseLayout.astro";
import Header from "@/components/sections/Header.astro";
import HeroSection from "@/components/sections/HeroSection.astro";
import FeaturesSection from "@/components/sections/FeaturesSection.astro";
import DetailedFeatures from "@/components/sections/DetailedFeatures.astro";
import FaqSection from "@/components/sections/FaqSection.astro";
import Footer from "@/components/sections/Footer.astro";
import { navItems, footerColumns, faqItems } from "@/lib/navigation";
---

<BaseLayout title="Handoff â€” Construction-Trained AI for Sales and Lead Intake">
  <Header navItems={navItems} />
  <HeroSection />
  <FeaturesSection />
  <DetailedFeatures />
  <FaqSection items={faqItems} />
  <Footer columns={footerColumns} />
</BaseLayout>

<script>
  import { initScrollAnimations } from "@/lib/animations";

  const header = document.getElementById("site-header");
  const heroContainer = document.getElementById("hero-container");
  const heroSection = document.getElementById("hero");
  const heroSpacer = document.getElementById("hero-spacer");
  const features = document.getElementById("features");

  function setSpacerHeight() {
    if (heroSection && heroSpacer) {
      heroSpacer.style.height = heroSection.offsetHeight + "px";
    }
  }

  if (heroSection) {
    setSpacerHeight();
    window.addEventListener("resize", setSpacerHeight);
  }

  window.addEventListener("scroll", () => {
    const scrollY = window.scrollY;

    if (header) {
      if (scrollY > 40) {
        header.classList.add("header-scrolled");
      } else {
        header.classList.remove("header-scrolled");
      }
    }

    if (heroContainer) {
      const fadeEnd = window.innerHeight * 0.5;
      const progress = Math.min(Math.max(scrollY / fadeEnd, 0), 1);
      heroContainer.style.opacity = String(1 - progress);
      heroContainer.style.transform = `translateY(${progress * -40}px)`;
    }

    if (features && heroSection) {
      const heroBottom = heroSection.offsetHeight;
      if (scrollY >= heroBottom) {
        features.classList.add("features-solid-bg");
      } else {
        features.classList.remove("features-solid-bg");
      }
    }
  });

  initScrollAnimations();
</script>
